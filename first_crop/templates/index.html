<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes" />
  <title>Crop Prediction</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body>
  <div class="leaf-container" id="leaves"></div>

  <div class="card">
    <h1>Crop Prediction</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <ul class="flashes" role="alert">
          {% for category, msg in messages %}
            <li class="{{ category }}">{{ msg }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <form action="{{ url_for('predict') }}" method="post" novalidate>
      <label for="nitrogen">Nitrogen (N):</label>
      <input type="number" id="nitrogen" name="nitrogen" step="any" required placeholder="e.g. 35" />

      <label for="phosphorus">Phosphorus (P):</label>
      <input type="number" id="phosphorus" name="phosphorus" step="any" required placeholder="e.g. 15" />

      <label for="potassium">Potassium (K):</label>
      <input type="number" id="potassium" name="potassium" step="any" required placeholder="e.g. 30" />

      <label for="temperature">Temperature (°C):</label>
      <input type="number" id="temperature" name="temperature" step="any" required placeholder="e.g. 25" />

      <label for="humidity">Humidity (%):</label>
      <input type="number" id="humidity" name="humidity" min="0" max="100" step="any" required placeholder="e.g. 55" />

      <label for="phvalue">pH Value:</label>
      <input type="number" id="phvalue" name="ph_value" step="0.1" min="3.5" max="8.5" required placeholder="e.g. 6.5" />

      <label for="rainfall">Rainfall (mm):</label>
      <input type="number" id="rainfall" name="rainfall" step="any" required placeholder="e.g. 100" />

      <button type="submit">Predict</button>
    </form>

    {% if prediction_text %}
      <div id="prediction_section">
        <h2 id="prediction_label">{{ prediction_text }}</h2>
      </div>
    {% endif %}
  </div>

  <script>
    (function() {
      const leafImg = "https://upload.wikimedia.org/wikipedia/commons/7/70/Leaf_%28PSF%29.png";
      const container = document.getElementById("leaves");

      function spawnLeaf() {
        const leaf = document.createElement("img");
        leaf.src = leafImg;
        leaf.alt = "";
        leaf.className = "leaf";

        const size = 20 + Math.random() * 24;
        leaf.style.width = `${size}px`;
        leaf.style.left = `${Math.random() * 100}%`;
        leaf.style.opacity = `${0.5 + Math.random() * 0.5}`;

        const d1 = 7 + Math.random() * 5;
        const d2 = 3 + Math.random() * 2;
        leaf.style.animation = `fall ${d1}s linear, sway ${d2}s ease-in-out infinite`;

        container.appendChild(leaf);
        leaf.addEventListener("animationend", () => leaf.remove());
      }

      for (let i = 0; i < 20; i++) spawnLeaf();
      setInterval(spawnLeaf, 900);
    })();
  </script>
</body>
</html>
